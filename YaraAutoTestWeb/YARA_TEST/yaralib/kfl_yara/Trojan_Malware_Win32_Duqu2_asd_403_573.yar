rule Trojan_Malware_Win32_Duqu2_asd_403_573
{
    meta:
        judge = "black"
        threatname = "Trojan[Malware]/Win32.Duqu2.asd"
        threattype = "Malware"
        family = "Duqu2"
        hacker = "None"
        author = "Florian Roth-copy"
        refer = "7699d7e0c7d6b2822992ad485caacb3e,84c2e7ff26e6dd500ec007d6d5d2255e"
        comment = "APT-DarkHotel"
        date = "2018-06-20"
        description = "Detects sample mentioned in the Dubnium Report"
    strings:
		$s0 = "Global\\{B54E3268-DE1E-4c1e-A667-2596751403AD}" fullword wide
		$s1 = "SetSecurityDescriptorSacl" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 189 times */
		$s2 = "msisvc_32@" fullword wide
		$s3 = "CompareStringA" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 1392 times */
		$s4 = "GetCommandLineW" fullword ascii /* PEStudio Blacklist: strings */ /* Goodware String - occured 1680 times */
    condition:
		uint16(0) == 0x5a4d and filesize < 150KB and all of them
}