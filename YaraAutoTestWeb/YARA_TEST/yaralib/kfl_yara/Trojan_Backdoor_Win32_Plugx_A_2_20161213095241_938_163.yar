rule Trojan_Backdoor_Win32_Plugx_A_2_20161213095241_938_163 
{
	meta:
		judge = "black"
		threatname = "Trojan[Backdoor]/Win32.Plugx.A"
		threattype = "rat"
		family = "Plugx"
		hacker = "None"
		refer = "534d28ad55831c04f4a7a8ace6dd76c3"
		description = "PlugXBoot"
		comment = "None"
		author = "Seth Hardy <seth.hardy@utoronto.ca>"
		date = "2016-06-23"
	strings:
		$s0 = { e8 00 00 00 00 58 }
		$s1 = { 80 38 47 75 36 80 78 01 65 75 30 80 78 02 74 75 2a 80 78 03 50 }
		$s2 = { C7 ( ?? ?? | ?? ?? ?? ?? ?? ) 4C 6F 61 64 C7 ( ?? ?? | ?? ?? ?? ?? ?? ) 4C 69 62 72 }
		$s3 = { C7 ( ?? ?? | ?? ?? ?? ?? ?? ) 56 69 72 74 C7 ( ?? ?? | ?? ?? ?? ?? ?? ) 75 61 6C 41 }
		$s4 = { C7 ( ?? ?? | ?? ?? ?? ?? ?? ) 56 69 72 74 C7 ( ?? ?? | ?? ?? ?? ?? ?? ) 75 61 6C 46 }
		$s5 = { C7 ( ?? ?? | ?? ?? ?? ?? ?? ) 45 78 69 74 C7 ( ?? ?? | ?? ?? ?? ?? ?? ) 54 68 72 65 }
		$s6 = { C7 ( ?? ?? | ?? ?? ?? ?? ?? ) 6E 74 64 6C 66 C7 ( ?? ?? | ?? ?? ?? ?? ?? ) C6 00 }
		$s7 = { C7 ( ?? ?? | ?? ?? ?? ?? ?? ) 52 74 6C 44 C7 ( ?? ?? | ?? ?? ?? ?? ?? ) 65 63 6F 6D }
		$s8 = { C7 ( ?? ?? | ?? ?? ?? ?? ?? ) 6D 65 6D 63 66 C7 ( ?? ?? | ?? ?? ?? ?? ?? ) 70 79 }
		$s9 = "boot.ldr" wide ascii
		$s10 = "d:\\work" nocase
		$s11 = "plug2.5"
		$s12 = "Plug3.0"
		$s13 = "Shell6"

	condition:
		($s0 at 0) or $s1 or ($s2 and $s3 and $s4 and $s5 and $s6 and $s7 and $s8) or $s9 or ($s10 and ($s11 or $s12 or $s13))
}
